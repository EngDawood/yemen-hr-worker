name = "yemen-hr-worker"
main = "src/index.ts"
compatibility_date = "2025-01-01"

[observability]
enabled = true

[observability.logs]
enabled = true
invocation_logs = true

[triggers]
crons = ["0 * * * *", "0 */6 * * *", "0 0 * * *", "0 23 * * *"]
# hourly, every 6h, daily (midnight), daily summary (11PM UTC)

[[kv_namespaces]]
binding = "POSTED_JOBS"
id = "d56f24496a1a48d7bf2cb6a325533d5c"

[[d1_databases]]
binding = "JOBS_DB"
database_name = "yemen-jobs"
database_id = "7e1e3ed7-1a37-4e81-a198-08a6080fff8a"

[ai]
binding = "AI"

[version_metadata]
binding = "CF_VERSION_METADATA"

[vars]
# Production channel
TELEGRAM_CHAT_ID = "-1001252486813"  # https://t.me/hr_yemen
# Configuration variables
ADMIN_CHAT_ID = "801062947"  # Personal Telegram ID for alerts
MAX_JOBS_PER_RUN = "25"
DELAY_BETWEEN_POSTS_MS = "1000"
LINKEDIN_URL = "https://www.linkedin.com/in/dawood3"
ENVIRONMENT = "production"
# AI Configuration
AI_MODEL = "@cf/qwen/qwen3-30b-a3b-fp8"  # Workers AI model for translation/summarization

# Secrets (set via wrangler secret put):
# - TELEGRAM_BOT_TOKEN

# ========== Preview Environment ==========
[env.preview]
name = "yemen-hr-worker-preview"

[[env.preview.kv_namespaces]]
binding = "POSTED_JOBS"
id = "6f106aa745654020a7ac382ff5a8cc32"  # Separate KV for preview

[[env.preview.d1_databases]]
binding = "JOBS_DB"
database_name = "yemen-jobs-preview"
database_id = "25561134-0af3-4031-953f-cbf2bfe89894"

[env.preview.ai]
binding = "AI"

[env.preview.version_metadata]
binding = "CF_VERSION_METADATA"

[env.preview.triggers]
crons = []

[env.preview.vars]
TELEGRAM_CHAT_ID = "-1003799523484"  # https://t.me/yemenjobss (preview)
# Configuration variables (same as production)
ADMIN_CHAT_ID = "801062947"  # Personal Telegram ID for alerts
MAX_JOBS_PER_RUN = "25"
DELAY_BETWEEN_POSTS_MS = "1000"
LINKEDIN_URL = "https://www.linkedin.com/in/dawood3"
ENVIRONMENT = "preview"
# AI Configuration
AI_MODEL = "@cf/openai/gpt-oss-120b"  # Testing GPT-OSS-120B for better translation quality

# Secret for preview: TELEGRAM_BOT_TOKEN (use preview bot token)
